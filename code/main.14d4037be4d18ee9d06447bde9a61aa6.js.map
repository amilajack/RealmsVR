{"version":3,"sources":["webpack:///./src/actions/types.js","webpack:///./src/services/api.js","webpack:///./src/actions/user.js","webpack:///./src/locales/index.js","webpack:///./src/locales/en.js","webpack:///./src/locales/es.js","webpack:///./src/reducers/lobby.js","webpack:///./src/reducers/realm.js","webpack:///./src/reducers/user.js","webpack:///./src/reducers/index.js","webpack:///./src/components/hands.js","webpack:///./src/components/renderer.jsx","webpack:///./src/components/session.jsx","webpack:///./src/components/lobby/floor.js","webpack:///./src/components/panel.js","webpack:///./src/components/lobby/menu.js","webpack:///./src/components/lobby/title.js","webpack:///./src/scenes/lobby.js","webpack:///./src/actions/lobby.js","webpack:///./src/services/mesher.js","webpack:///./src/actions/realm.js","webpack:///./src/components/realm/picker.js","webpack:///./src/components/realm/voxels.js","webpack:///./src/scenes/realm.js","webpack:///./src/scenes/index.jsx","webpack:///./src/layout/index.jsx","webpack:///./src/index.jsx","webpack:///./src/services/mesher.worker.js"],"names":["REALM_FETCH_FULFILLED","REALM_UPDATE_GEOMETRY","REALM_UPDATE_VOXELS","REALM_RESET","USER_REFRESH_SESSION_FULFILLED","USER_REFRESH_SESSION_REJECTED","USER_SIGNOUT","api","API","_classCallCheck","this","baseURL","__API__","body","_ref","endpoint","_ref$headers","headers","_ref$method","method","authorization","Authorization","FormData","JSON","stringify","fetch","concat","then","res","status","Error","get","split","arrayBuffer","json","token","refreshSession","session","type","types","payload","dispatch","catch","locales","en","NotFound","description","goBack","User","signIn","signOut","es","availableLocales","Object","keys","defaultLocale","translations","forEach","locale","merge","lobbyReducer","combineReducers","realms","state","arguments","length","undefined","action","realmReducer","geometry","id","_id","name","size","voxels","Uint32Array","sessionKey","storedSession","parse","localStorage","getItem","setAuthorization","userReducer","isAuth","profile","setItem","removeItem","rootReducer","i18n","loadingBar","lobby","realm","user","Hands","_this","hands_classCallCheck","mesh","pointerMesh","setup","_possibleConstructorReturn","_getPrototypeOf","call","_loop","i","hand","clone","buttons","menu","menuDown","menuUp","grip","gripDown","gripUp","pad","padDown","padUp","trigger","triggerDown","triggerUp","pointer","visible","add","matrixAutoUpdate","setupRaycaster","raycaster","Object3D","_ref2","auxMatrix","Matrix4","matrixWorld","identity","extractRotation","ray","origin","setFromMatrixPosition","direction","set","applyMatrix4","addScaledVector","BoxGeometry","scale","translate","faces","face","color","offsetHSL","BufferGeometry","fromGeometry","material","MeshBasicMaterial","Mesh","pointerGeometry","setFromPoints","Vector3","pointerMaterial","LineBasicMaterial","Line","children","gamepads","navigator","getGamepads","gamepad","startsWith","pose","updateHand","standingMatrix","position","fromArray","orientation","quaternion","matrix","compose","premultiply","matrixWorldNeedsUpdate","pressed","Renderer","props","renderer_classCallCheck","renderer_getPrototypeOf","canvas","React","createRef","onAnimationTick","bind","renderer_assertThisInitialized","onResize","Component","current","camera","PerspectiveCamera","clock","Clock","Raycaster","far","room","hands","resetCamera","resetScene","renderer","WebGLRenderer","antialias","powerPreference","stencil","setPixelRatio","window","devicePixelRatio","setClearColor","scene","fog","setAnimationLoop","addEventListener","setupVR","animation","delta","getDelta","time","oldTime","update","render","_canvas$parentNode$ge","parentNode","getBoundingClientRect","width","height","vr","isPresenting","setSize","aspect","updateProjectionMatrix","capabilities","getMaxAnisotropy","hasWebXR","hasWebVR","enterVR","display","getDevice","requestSession","immersive","exclusive","setSession","frameOfReferenceType","xr","requestDevice","enabled","setDevice","requestPresent","source","domElement","getVRDisplays","displays","_slicedToArray","getStandingMatrix","rotation","Scene","FogExp2","setRGB","react_default","a","createElement","ref","ShaderChunk","fog_pars_vertex","replace","fog_vertex","fog_pars_fragment","fog_fragment","join","Wrapper","styled","div","withConfig","displayName","componentId","Session","session_classCallCheck","session_getPrototypeOf","loginWithGoogle","session_assertThisInitialized","onMessage","PureComponent","popupWatcher","removeEventListener","clearInterval","data","indexOf","_this2","screenX","screenY","left","screen","top","win","open","setInterval","postMessage","_this$props","signout","onClick","ti","react_redux_i18n_build","value","propTypes","PropTypes","bool","isRequired","func","connect","_ref3","Floor","floor_classCallCheck","PlaneGeometry","rotateX","Math","PI","Color","copy","setHex","random","floor_possibleConstructorReturn","floor_getPrototypeOf","vertexColors","VertexColors","Panel","anisotropy","panel_classCallCheck","document","texture","CanvasTexture","panel_possibleConstructorReturn","panel_getPrototypeOf","PlaneBufferGeometry","map","backplate","rotateY","context","getContext","ctx","fillStyle","fillRect","needsUpdate","point","worldToLocal","x","y","Realm","onPointer","menu_classCallCheck","menu_possibleConstructorReturn","menu_getPrototypeOf","draw","isHover","_get","prototype","font","textAlign","textBaseline","fillText","Menu","history","hover","_this3","remove","offset","panel","_objectSpread","_ref4","isDown","setHover","push","slug","lookAt","Title","title_classCallCheck","title_possibleConstructorReturn","title_getPrototypeOf","transparent","setTimeout","grd","createLinearGradient","addColorStop","Lobby","fetchRealms","onBeforeRender","page","previousRealms","_this$renderer","hit","intersectObjects","distance","object","z","arrayOf","shape","string","instanceOf","_ref$page","mesher","Mesher","mesher_classCallCheck","promiseId","promises","worker","Worker","onmessage","Promise","resolve","_ref2$data","generateGeometry","generate","Picker","picker_classCallCheck","picker_assertThisInitialized","picker_getPrototypeOf","block","strip","blockColor","picker_get","save","getHexString","grdWhite","grdBlack","restore","rect","isStrip","imageData","getImageData","Voxels","voxels_classCallCheck","voxels_possibleConstructorReturn","voxels_getPrototypeOf","instance","updateMatrix","index","normal","attributes","setArray","addAttribute","BufferAttribute","setIndex","computeBoundingSphere","match","params","picker","intersects","head","previousGeometry","previousSize","_this$props2","resize","realm_toConsumableArray","reset","_this$props3","updateVoxels","_map2","scenes_realm_slicedToArray","axis","sin","translateZ","updateMatrixWorld","Float32Array","number","_ref2$realm","realm_objectSpread","getState","_getState$realm","realm_slicedToArray","floor","randomized","min","max","round","r","g","b","component","rest","_objectWithoutProperties","react_router","_extends","Scenes","scenes_Scene","exact","path","to","store","storedLocale","browserLocale","loadingBarStyle","backgroundColor","zIndex","Layout","layout_classCallCheck","layout_possibleConstructorReturn","layout_getPrototypeOf","build_default","style","layout_Wrapper","components_renderer","scenes","components_session","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","productionCompose","createStore","applyMiddleware","thunkMiddleware","promiseMiddleware","loadingBarMiddleware","languages","language","browserLanguage","userLanguage","substr","toLowerCase","syncTranslationWithStore","loadTranslations","setLocale","createBrowserHistory","basename","__BASENAME__","location","hash","e","preventDefault","mount","getElementById","react_redux_es","layout","module","exports","__webpack_require__","p"],"mappings":"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","file":"code/main.1e07d3d373a670c481b9.js","sourcesContent":["// LOBBY\nexport const LOBBY_FETCH_REALMS = 'LOBBY/FETCH_REALMS';\nexport const LOBBY_FETCH_REALMS_FULFILLED = 'LOBBY/FETCH_REALMS_FULFILLED';\n\n// REALM\nexport const REALM_CREATE = 'REALM/CREATE';\nexport const REALM_CREATE_FULFILLED = 'REALM/CREATE_FULFILLED';\nexport const REALM_FETCH = 'REALM/FETCH';\nexport const REALM_FETCH_FULFILLED = 'REALM/FETCH_FULFILLED';\nexport const REALM_UPDATE_GEOMETRY = 'REALM/UPDATE_GEOMETRY';\nexport const REALM_UPDATE_GEOMETRY_FULFILLED = 'REALM/UPDATE_GEOMETRY_FULFILLED';\nexport const REALM_UPDATE_VOXELS = 'REALM/UPDATE_VOXELS';\nexport const REALM_RESET = 'REALM/RESET';\n\n// USER\nexport const USER_REFRESH_SESSION = 'USER/REFRESH_SESSION';\nexport const USER_REFRESH_SESSION_FULFILLED = 'USER/REFRESH_SESSION_FULFILLED';\nexport const USER_REFRESH_SESSION_REJECTED = 'USER/REFRESH_SESSION_REJECTED';\nexport const USER_SIGNOUT = 'USER/SIGNOUT';\n","class API {\n  constructor() {\n    this.baseURL = __API__;\n  }\n\n  fetch({\n    body,\n    endpoint,\n    headers = {},\n    method = 'GET',\n  }) {\n    const {\n      authorization,\n      baseURL,\n    } = this;\n    if (authorization) {\n      headers.Authorization = authorization;\n    }\n    if (body && !(body instanceof FormData)) {\n      body = JSON.stringify(body);\n      headers['Content-Type'] = 'application/json';\n    }\n    return fetch(\n      `${baseURL}${endpoint}`,\n      {\n        body,\n        headers,\n        method,\n      }\n    )\n      .then((res) => {\n        const { headers, status } = res;\n        if (status < 200 || status >= 400) {\n          throw new Error(status);\n        }\n        const type = (headers.get('Content-Type') || '').split(';')[0];\n        switch (type) {\n          case 'text/plain':\n            return res.arrayBuffer();\n          case 'application/json':\n            return res.json();\n          default:\n            return res;\n        }\n      });\n  }\n\n  setAuthorization(token) {\n    if (token) {\n      this.authorization = `Bearer ${token}`;\n    } else {\n      delete this.authorization;\n    }\n    this.token = token;\n  }\n}\n\nexport default new API();\n","import { setLocale as reduxSetLocale } from 'react-redux-i18n';\nimport * as types from './types';\nimport API from '@/services/api';\n\nexport function refreshSession(session) {\n  if (session) {\n    return {\n      type: types.USER_REFRESH_SESSION_FULFILLED,\n      payload: session,\n    };\n  }\n  return dispatch => dispatch({\n    type: types.USER_REFRESH_SESSION,\n    payload: API.fetch({\n      endpoint: 'user',\n    }),\n  }).catch(() => {});\n}\n\nexport function setLocale(locale) {\n  return (dispatch) => {\n    localStorage.setItem('REALMSVR::LOCALE', locale);\n    dispatch(reduxSetLocale(locale));\n  };\n}\n\nexport function signout() {\n  return {\n    type: types.USER_SIGNOUT,\n  };\n}\n","import diff from 'deep-diff';\nimport { recursive as merge } from 'merge';\nimport { loadTranslations, setLocale, syncTranslationWithStore } from 'react-redux-i18n';\nimport en from './en';\nimport es from './es';\n\nconst locales = {\n  en,\n  es,\n};\nconst availableLocales = Object.keys(locales);\nconst defaultLocale = 'en';\n\n// Populate locales with default literals\nconst translations = {};\navailableLocales.forEach((locale) => {\n  translations[locale] = merge(true, locales[defaultLocale], locales[locale]);\n});\n\n// Translations loader handler (for hot-reloading)\nexport const load = (store) => {\n  store.dispatch(loadTranslations(translations));\n};\n\nexport default (store) => {\n  // Locale Autodetection\n  const storedLocale = localStorage.getItem('REALMSVR::LOCALE');\n  const browserLocale = (\n    (window.navigator.languages ? window.navigator.languages[0] : null)\n    || window.navigator.language\n    || window.navigator.browserLanguage\n    || window.navigator.userLanguage\n    || defaultLocale\n  ).substr(0, 2).toLowerCase();\n\n  let locale = defaultLocale;\n  if (~availableLocales.indexOf(storedLocale)) locale = storedLocale;\n  else if (~availableLocales.indexOf(browserLocale)) locale = browserLocale;\n\n  // Setup react-i18nify\n  syncTranslationWithStore(store);\n  load(store);\n  store.dispatch(setLocale(locale));\n\n  if (!__PRODUCTION__) {\n    // Warn about missing translations\n    const missing = availableLocales\n      .reduce((missing, locale) => {\n        if (locale === defaultLocale) {\n          return missing;\n        }\n        const keys = diff(locales[defaultLocale], locales[locale])\n          .reduce((missing, { kind, path }) => {\n            if (kind === 'E') {\n              return missing;\n            }\n            return [\n              ...missing,\n              path.join('.'),\n            ];\n          }, []);\n        if (!keys.length) {\n          return missing;\n        }\n        return [\n          ...missing,\n          `\\nMissing translations for \"${locale.toUpperCase()}\" locale:`,\n          ...keys,\n        ];\n      }, []);\n    if (missing.length) {\n      console.warn(missing.join('\\n'));\n    }\n  }\n};\n","export default {\n  NotFound: {\n    description: 'This is not the web page you\\'re looking for.',\n    goBack: 'Take me back home',\n  },\n  User: {\n    signIn: 'Sign-In',\n    signOut: 'Sign-Out',\n  },\n};\n","export default {\n  NotFound: {\n    description: 'Esta no es la página que estás buscando.',\n    goBack: 'Volver al inicio',\n  },\n  User: {\n    signIn: 'Iniciar sesión',\n    signOut: 'Cerrar sesión',\n  },\n};\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst realms = (\n  state = [],\n  action\n) => {\n  switch (action.type) {\n    case types.LOBBY_FETCH_REALMS_FULFILLED:\n      return action.payload;\n    default:\n      return state;\n  }\n};\n\nconst lobbyReducer = combineReducers({\n  realms,\n});\n\nexport default lobbyReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\n\nconst geometry = (\n  state = {},\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_UPDATE_GEOMETRY_FULFILLED:\n      return action.payload;\n    case types.REALM_RESET:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst id = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload._id;\n    case types.REALM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst name = (\n  state = '',\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload.name;\n    case types.REALM_RESET:\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst size = (\n  state = 0,\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n      return action.payload.size;\n    case types.REALM_RESET:\n      return 0;\n    default:\n      return state;\n  }\n};\n\nconst voxels = (\n  state = new Uint32Array(),\n  action\n) => {\n  switch (action.type) {\n    case types.REALM_FETCH_FULFILLED:\n    case types.REALM_UPDATE_VOXELS:\n      return action.payload.voxels;\n    case types.REALM_RESET:\n      return new Uint32Array();\n    default:\n      return state;\n  }\n};\n\nconst realmReducer = combineReducers({\n  geometry,\n  id,\n  name,\n  size,\n  voxels,\n});\n\nexport default realmReducer;\n","import { combineReducers } from 'redux';\nimport * as types from '@/actions/types';\nimport API from '@/services/api';\n\nconst sessionKey = 'REALMSVR::SESSION';\nconst storedSession = JSON.parse(\n  localStorage.getItem(sessionKey) || 'false'\n);\nif (storedSession) {\n  API.setAuthorization(storedSession.token);\n}\n\nconst isAuth = (\n  state = !!storedSession,\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n      return true;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return false;\n    default:\n      return state;\n  }\n};\n\nconst profile = (\n  state = storedSession ? storedSession.profile : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n      return action.payload.profile;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      return {};\n    default:\n      return state;\n  }\n};\n\nconst token = (\n  state = storedSession ? storedSession.token : {},\n  action\n) => {\n  switch (action.type) {\n    case types.USER_REFRESH_SESSION_FULFILLED:\n      API.setAuthorization(action.payload.token);\n      localStorage.setItem(sessionKey, JSON.stringify(action.payload));\n      return action.payload.token;\n    case types.USER_REFRESH_SESSION_REJECTED:\n    case types.USER_SIGNOUT:\n      API.setAuthorization(false);\n      localStorage.removeItem(sessionKey);\n      return '';\n    default:\n      return state;\n  }\n};\n\nconst userReducer = combineReducers({\n  isAuth,\n  profile,\n  token,\n});\n\nexport default userReducer;\n","import { combineReducers } from 'redux';\nimport { i18nReducer as i18n } from 'react-redux-i18n';\nimport { loadingBarReducer as loadingBar } from 'react-redux-loading-bar';\nimport lobby from './lobby';\nimport realm from './realm';\nimport user from './user';\n\nconst rootReducer = combineReducers({\n  i18n,\n  loadingBar,\n  lobby,\n  realm,\n  user,\n});\n\nexport default rootReducer;\n","import {\n  BoxGeometry,\n  BufferGeometry,\n  Line,\n  LineBasicMaterial,\n  Matrix4,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  Vector3,\n} from 'three';\n\nclass Hands extends Object3D {\n  constructor() {\n    if (\n      !Hands.mesh\n      || !Hands.pointerMesh\n    ) Hands.setup();\n\n    super();\n    const { mesh, pointerMesh } = Hands;\n    for (let i = 0; i < 2; i += 1) {\n      const hand = mesh.clone();\n      hand.buttons = {\n        menu: false,\n        menuDown: false,\n        menuUp: false,\n        grip: false,\n        gripDown: false,\n        gripUp: false,\n        pad: false,\n        padDown: false,\n        padUp: false,\n        trigger: false,\n        triggerDown: false,\n        triggerUp: false,\n      };\n      hand.pointer = pointerMesh.clone();\n      hand.pointer.visible = false;\n      hand.add(hand.pointer);\n      hand.matrixAutoUpdate = false;\n      hand.setupRaycaster = raycaster => Hands.setupRaycaster({ hand, raycaster });\n      hand.visible = false;\n      this.add(hand);\n    }\n  }\n\n  update() {\n    const { children } = this;\n    const gamepads = ('getGamepads' in navigator ? navigator.getGamepads() : []);\n    children.forEach((hand) => {\n      hand.visible = false;\n    });\n    let hand = 0;\n    for (let i = 0; i < gamepads.length; i += 1) {\n      const gamepad = gamepads[i];\n      if (\n        gamepad\n        && (\n          gamepad.id === 'OpenVR Gamepad'\n          || gamepad.id.startsWith('Oculus Touch')\n          || gamepad.id.startsWith('Spatial Controller')\n        )\n      ) {\n        if (gamepad.pose) {\n          this.updateHand({\n            hand: children[hand],\n            buttons: gamepad.buttons,\n            pose: gamepad.pose,\n          });\n        }\n        hand += 1;\n        if (hand > 1) break;\n      }\n    }\n  }\n\n  updateHand({\n    hand,\n    buttons,\n    pose,\n  }) {\n    const { standingMatrix } = this;\n    if (pose.position !== null) {\n      hand.position.fromArray(pose.position);\n    }\n    if (pose.orientation !== null) {\n      hand.quaternion.fromArray(pose.orientation);\n    }\n    hand.matrix.compose(hand.position, hand.quaternion, hand.scale);\n    hand.matrix.premultiply(standingMatrix);\n    hand.matrixWorldNeedsUpdate = true;\n    hand.visible = true;\n\n    const menu = buttons[3] && buttons[3].pressed;\n    hand.buttons.menuDown = menu && hand.buttons.menu !== menu;\n    hand.buttons.menuUp = !menu && hand.buttons.menu !== menu;\n    hand.buttons.menu = menu;\n    const grip = buttons[2] && buttons[2].pressed;\n    hand.buttons.gripDown = grip && hand.buttons.grip !== grip;\n    hand.buttons.gripUp = !grip && hand.buttons.grip !== grip;\n    hand.buttons.grip = grip;\n    const pad = buttons[0] && buttons[0].pressed;\n    hand.buttons.padDown = pad && hand.buttons.pad !== pad;\n    hand.buttons.padUp = !pad && hand.buttons.pad !== pad;\n    hand.buttons.pad = pad;\n    const trigger = buttons[1] && buttons[1].pressed;\n    hand.buttons.triggerDown = trigger && hand.buttons.trigger !== trigger;\n    hand.buttons.triggerUp = !trigger && hand.buttons.trigger !== trigger;\n    hand.buttons.trigger = trigger;\n  }\n\n  static setupRaycaster({ hand, raycaster }) {\n    if (!hand.auxMatrix) {\n      hand.auxMatrix = new Matrix4();\n    }\n    const { auxMatrix, matrixWorld } = hand;\n    auxMatrix.identity().extractRotation(matrixWorld);\n    raycaster.ray.origin.setFromMatrixPosition(matrixWorld);\n    raycaster.ray.direction.set(0, 0, -1).applyMatrix4(auxMatrix);\n    raycaster.ray.origin.addScaledVector(raycaster.ray.direction, -0.175);\n  }\n\n  static setup() {\n    if (!Hands.geometry) {\n      const geometry = new BoxGeometry(1, 1, 1);\n      geometry.scale(0.05, 0.03, 0.2);\n      geometry.translate(0, 0, 0.075);\n      geometry.faces.forEach((face, i) => {\n        face.color.set(0x777777);\n        if (i >= 10 && i <= 11) {\n          face.color.offsetHSL(0, 0, -0.1);\n        }\n      });\n      Hands.geometry = (new BufferGeometry()).fromGeometry(geometry);\n    }\n    if (!Hands.material) {\n      Hands.material = new MeshBasicMaterial({\n        color: 0xffe0bd,\n      });\n    }\n    if (!Hands.mesh) {\n      Hands.mesh = new Mesh(\n        Hands.geometry,\n        Hands.material\n      );\n    }\n    if (!Hands.pointerGeometry) {\n      Hands.pointerGeometry = (new BufferGeometry())\n        .setFromPoints([new Vector3(0, 0, 0), new Vector3(0, 0, -1)]);\n    }\n    if (!Hands.pointerMaterial) {\n      Hands.pointerMaterial = new LineBasicMaterial({\n        color: 0xffe0bd,\n      });\n    }\n    if (!Hands.pointerMesh) {\n      Hands.pointerMesh = new Line(\n        Hands.pointerGeometry,\n        Hands.pointerMaterial\n      );\n    }\n  }\n}\n\nexport default Hands;\n","import React, { Component } from 'react';\nimport {\n  Clock,\n  FogExp2,\n  Object3D,\n  PerspectiveCamera,\n  Raycaster,\n  Scene,\n  ShaderChunk,\n  WebGLRenderer,\n} from 'three';\nimport Hands from './hands';\n\nclass Renderer extends Component {\n  constructor(props) {\n    super(props);\n    this.canvas = React.createRef();\n    this.onAnimationTick = this.onAnimationTick.bind(this);\n    this.onResize = this.onResize.bind(this);\n  }\n\n  componentDidMount() {\n    const { canvas: { current: canvas } } = this;\n    this.camera = new PerspectiveCamera(90, 1, 0.1, 1024);\n    this.clock = new Clock();\n    this.raycaster = new Raycaster();\n    this.raycaster.far = 32;\n    this.room = new Object3D();\n    this.room.add(this.camera);\n    this.hands = new Hands();\n    this.room.add(this.hands);\n    this.resetCamera();\n    this.resetScene();\n    const renderer = new WebGLRenderer({\n      antialias: true,\n      canvas,\n      powerPreference: 'high-performance',\n      stencil: false,\n    });\n    renderer.setPixelRatio(window.devicePixelRatio || 1);\n    renderer.setClearColor(this.scene.fog.color);\n    renderer.setAnimationLoop(this.onAnimationTick);\n    window.addEventListener('resize', this.onResize, false);\n    this.renderer = renderer;\n    this.onResize();\n    this.setupVR();\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  onAnimationTick() {\n    const {\n      camera,\n      clock,\n      hands,\n      renderer,\n      scene,\n    } = this;\n    renderer.animation = {\n      delta: clock.getDelta(),\n      time: clock.oldTime / 1000,\n    };\n    hands.update();\n    renderer.render(scene, camera);\n  }\n\n  onResize() {\n    const {\n      canvas: { current: canvas },\n      camera,\n      renderer,\n    } = this;\n    const { width, height } = canvas.parentNode.getBoundingClientRect();\n    if (!renderer.vr.isPresenting()) {\n      renderer.setSize(width, height);\n    }\n    camera.aspect = width / height;\n    camera.updateProjectionMatrix();\n  }\n\n  getMaxAnisotropy() {\n    const { renderer } = this;\n    return renderer.capabilities.getMaxAnisotropy();\n  }\n\n  setupVR() {\n    const { hands, renderer } = this;\n    const hasWebXR = 'xr' in navigator;\n    const hasWebVR = 'getVRDisplays' in navigator;\n    if (hasWebXR) {\n      // TODO:\n      // Verify that this actually works\n      const enterVR = () => {\n        if (renderer.vr.isPresenting()) return;\n        const display = renderer.vr.getDevice();\n        if (!display) {\n          navigator.xr.requestDevice().then((display) => {\n            renderer.vr.enabled = true;\n            renderer.vr.setDevice(display);\n          });\n          return;\n        }\n        display\n          .requestSession({ immersive: true, exclusive: true /* DEPRECATED */ })\n          .then((session) => {\n            renderer.vr.setSession(session, { frameOfReferenceType: 'stage' });\n          });\n      };\n      window.addEventListener('mousedown', enterVR, false);\n      enterVR();\n    } else if (hasWebVR) {\n      const enterVR = () => {\n        if (renderer.vr.isPresenting()) return;\n        const display = renderer.vr.getDevice();\n        if (!display) {\n          navigator.getVRDisplays().then((displays) => {\n            if (!displays.length) return;\n            const [display] = displays;\n            renderer.vr.enabled = true;\n            renderer.vr.setDevice(display);\n          });\n          return;\n        }\n        display.requestPresent([{ source: renderer.domElement }]);\n      };\n      window.addEventListener('mousedown', enterVR, false);\n      window.addEventListener('vrdisplayactivate', enterVR, false);\n      enterVR();\n    }\n    hands.standingMatrix = renderer.vr.getStandingMatrix();\n  }\n\n  resetCamera() {\n    const { camera } = this;\n    camera.position.set(0, 1.6, 0);\n    camera.rotation.set(0, 0, 0);\n  }\n\n  resetScene() {\n    this.room.position.set(0, 0, 0);\n    this.scene = new Scene();\n    this.scene.add(this.room);\n    this.scene.fog = new FogExp2(0, 0.015);\n    this.scene.fog.color.setRGB(0, 0, 0.1);\n    return this.scene;\n  }\n\n  render() {\n    const { canvas } = this;\n    return (\n      <canvas ref={canvas} />\n    );\n  }\n}\n\n// Fix threeJS Fog\nShaderChunk.fog_pars_vertex = ShaderChunk.fog_pars_vertex.replace(\n  'varying float fogDepth;',\n  'varying vec4 fogDepth;'\n);\nShaderChunk.fog_vertex = ShaderChunk.fog_vertex.replace(\n  'fogDepth = -mvPosition.z;',\n  'fogDepth = mvPosition;'\n);\nShaderChunk.fog_pars_fragment = ShaderChunk.fog_pars_fragment.replace(\n  'varying float fogDepth;',\n  'varying vec4 fogDepth;'\n);\nShaderChunk.fog_fragment = ShaderChunk.fog_fragment.replace(\n  'float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );',\n  [\n    'float fogDist = length(fogDepth);',\n    'float fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDist * fogDist * LOG2 ) );',\n  ].join('\\n')\n).replace(\n  'float fogFactor = smoothstep( fogNear, fogFar, fogDepth );',\n  'float fogFactor = smoothstep( fogNear, fogFar, length(fogDepth) );'\n);\n\nexport default Renderer;\n","import PropTypes from 'prop-types';\nimport React, { PureComponent } from 'react';\nimport { TiEject, TiSocialGooglePlus } from 'react-icons/ti';\nimport { connect } from 'react-redux';\nimport { Translate } from 'react-redux-i18n';\nimport styled from 'styled-components';\nimport { refreshSession, signout } from '@/actions/user';\nimport API from '@/services/api';\n\nconst Wrapper = styled.div`\n  position: fixed;\n  top: 0;\n  right: 0;\n  > button {\n    display: flex;\n    align-items: center;\n    outline: 0;\n    font-family: inherit;\n    font-size: 1.2rem;\n    font-weight: 700;\n    width: 150px;\n    padding: 0.5rem 1rem;\n    > svg {\n      margin-right: 0.5rem;\n    }\n  }\n`;\n\nclass Session extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.loginWithGoogle = this.loginWithGoogle.bind(this);\n    this.onMessage = this.onMessage.bind(this);\n  }\n\n  componentWillUnmount() {\n    const { popupWatcher } = this;\n    if (popupWatcher) {\n      window.removeEventListener('message', this.onMessage);\n      clearInterval(popupWatcher);\n      delete this.popupWatcher;\n    }\n  }\n\n  onMessage({ origin, data: { session } }) {\n    const { popupWatcher } = this;\n    const { refreshSession } = this.props;\n    if (API.baseURL.indexOf(origin) === 0) {\n      window.removeEventListener('message', this.onMessage);\n      clearInterval(popupWatcher);\n      delete this.popupWatcher;\n      if (session) {\n        refreshSession(session);\n      }\n    }\n  }\n\n  loginWithGoogle({ screenX, screenY }) {\n    const w = 512;\n    const h = 512;\n    const left = (screenX || (window.screen.width / 2)) - w;\n    const top = (screenY || (window.screen.height / 2));\n    const win = window.open(\n      `${API.baseURL}user/google`,\n      'loginWithGoogle',\n      `width=${w},height=${h},top=${top},left=${left}`\n    );\n    if (this.popupWatcher) {\n      window.removeEventListener('message', this.onMessage);\n      clearInterval(this.popupWatcher);\n    }\n    this.popupWatcher = setInterval(() => {\n      if (!win.window) {\n        clearInterval(this.popupWatcher);\n        delete this.popupWatcher;\n        return;\n      }\n      win.postMessage(true, API.baseURL);\n    }, 100);\n    window.addEventListener('message', this.onMessage, false);\n  }\n\n  render() {\n    const { isAuth, signout } = this.props;\n    return (\n      <Wrapper>\n        {isAuth ? (\n          <button\n            type=\"button\"\n            onClick={signout}\n          >\n            <TiEject />\n            <Translate value=\"User.signOut\" />\n          </button>\n        ) : (\n          <button\n            type=\"button\"\n            onClick={this.loginWithGoogle}\n          >\n            <TiSocialGooglePlus />\n            <Translate value=\"User.signIn\" />\n          </button>\n        )}\n      </Wrapper>\n    );\n  }\n}\n\nSession.propTypes = {\n  isAuth: PropTypes.bool.isRequired,\n  refreshSession: PropTypes.func.isRequired,\n  signout: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    user: { isAuth },\n  }) => ({\n    isAuth,\n  }),\n  {\n    refreshSession,\n    signout,\n  }\n)(Session);\n","import {\n  BufferGeometry,\n  Color,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneGeometry,\n  VertexColors,\n} from 'three';\n\nclass Floor extends Mesh {\n  constructor() {\n    const size = 256;\n    const geometry = new PlaneGeometry(size, size, size, size);\n    geometry.rotateX(Math.PI * -0.5);\n    const color = new Color();\n    geometry.faces.forEach((face, i) => {\n      if (i % 2 === 1) {\n        face.color.copy(color);\n      } else {\n        face.color.setHex(0x555555);\n        face.color.offsetHSL(0, 0, Math.random() * -0.1);\n        color.copy(face.color);\n      }\n    });\n    super(\n      (new BufferGeometry()).fromGeometry(geometry),\n      new MeshBasicMaterial({\n        vertexColors: VertexColors,\n      })\n    );\n  }\n}\n\nexport default Floor;\n","import {\n  CanvasTexture,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n  Vector3,\n} from 'three';\n\nclass Panel extends Mesh {\n  constructor({ anisotropy }) {\n    const renderer = document.createElement('canvas');\n    renderer.width = 512;\n    renderer.height = 512;\n    const texture = new CanvasTexture(renderer);\n    texture.anisotropy = anisotropy;\n    super(\n      new PlaneBufferGeometry(1, 1),\n      new MeshBasicMaterial({\n        map: texture,\n      })\n    );\n    {\n      const backplate = new Mesh(\n        new PlaneBufferGeometry(1, 1),\n        new MeshBasicMaterial({\n          color: 0x111111,\n        })\n      );\n      backplate.geometry.rotateY(Math.PI);\n      this.add(backplate);\n    }\n    this.context = renderer.getContext('2d');\n    this.pointer = new Vector3();\n    this.renderer = renderer;\n    this.texture = texture;\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      renderer,\n      texture,\n    } = this;\n    ctx.fillStyle = '#111';\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    texture.needsUpdate = true;\n  }\n\n  onPointer(point) {\n    const { pointer, renderer } = this;\n    this.worldToLocal(pointer.copy(point));\n    pointer.set(\n      (pointer.x + 0.5) * renderer.width,\n      (1 - (pointer.y + 0.5)) * renderer.height,\n      0\n    );\n  }\n}\n\nexport default Panel;\n","import {\n  Object3D,\n} from 'three';\nimport Panel from '@/components/panel';\n\nclass Realm extends Panel {\n  constructor({ anisotropy, name, onPointer }) {\n    super({ anisotropy });\n    this.scale.set(0.25, 0.25, 1);\n    this.name = name;\n    this.onPointer = onPointer;\n    this.draw();\n  }\n\n  draw() {\n    const {\n      context: ctx,\n      isHover,\n      name,\n      renderer,\n    } = this;\n    super.draw();\n    ctx.fillStyle = isHover ? '#333' : '#111';\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    ctx.font = '80px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = '#fff';\n    ctx.fillText(\n      name,\n      renderer.width * 0.5,\n      renderer.height * 0.5\n    );\n  }\n}\n\nclass Menu extends Object3D {\n  constructor({ anisotropy, history }) {\n    super();\n    this.anisotropy = anisotropy;\n    this.history = history;\n    this.hover = {};\n    this.position.set(0, 1.25, -1);\n  }\n\n  setHover({ hand, realm }) {\n    const { hover } = this;\n    if (hover[hand]) {\n      hover[hand].isHover = false;\n      hover[hand].draw();\n    }\n    if (realm) {\n      realm.isHover = true;\n      realm.draw();\n    }\n    this.hover[hand] = realm;\n  }\n\n  update(realms) {\n    const {\n      anisotropy,\n      children,\n      history,\n    } = this;\n    while (children.length) {\n      this.remove(children[0]);\n    }\n    const offset = 0.25 + realms.length * -0.25;\n    realms.forEach((realm, i) => {\n      const panel = new Realm({\n        ...realm,\n        anisotropy,\n        onPointer: ({ hand, isDown }) => {\n          this.setHover({ hand, realm: panel });\n          if (isDown) {\n            history.push(`/${realm.slug}`);\n          }\n        },\n      });\n      panel.position.set(\n        offset + (i * 0.5),\n        0,\n        0\n      );\n      panel.lookAt(0, 0.5, 1);\n      this.add(panel);\n    });\n  }\n}\n\nexport default Menu;\n","import {\n  CanvasTexture,\n  Mesh,\n  MeshBasicMaterial,\n  PlaneBufferGeometry,\n} from 'three';\n\nclass Title extends Mesh {\n  constructor({ anisotropy }) {\n    const renderer = document.createElement('canvas');\n    renderer.width = 1024;\n    renderer.height = 1024;\n    const texture = new CanvasTexture(renderer);\n    texture.anisotropy = anisotropy;\n    super(\n      new PlaneBufferGeometry(2, 2),\n      new MeshBasicMaterial({\n        map: texture,\n        transparent: true,\n      })\n    );\n    this.lookAt(0, -0.25, 1);\n    this.position.set(0, 2, -3);\n    this.renderer = renderer;\n    this.texture = texture;\n    setTimeout(() => this.draw(), 250);\n  }\n\n  draw() {\n    const { renderer, texture } = this;\n    const ctx = renderer.getContext('2d');\n    const grd = ctx.createLinearGradient(0, 0, 0, renderer.height);\n    grd.addColorStop(0, 'rgba(0,0,0,0.25)');\n    grd.addColorStop(1, 'rgba(0,0,0,0)');\n    ctx.fillStyle = grd;\n    ctx.fillRect(0, 0, renderer.width, renderer.height);\n    ctx.font = '700 200px Roboto';\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'middle';\n    ctx.fillStyle = '#eee';\n    ctx.fillText(\n      'RealmsVR',\n      renderer.width * 0.5,\n      renderer.height * 0.2\n    );\n    ctx.font = '60px Roboto';\n    ctx.fillStyle = '#999';\n    ctx.fillText(\n      'A recursive VR experience',\n      renderer.width * 0.5,\n      renderer.height * 0.5\n    );\n    ctx.font = '60px Roboto';\n    ctx.fillStyle = '#bbb';\n    ctx.fillText(\n      'dani@gatunes © 2019',\n      renderer.width * 0.5,\n      renderer.height * 0.8\n    );\n    texture.needsUpdate = true;\n  }\n}\n\nexport default Title;\n","import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { fetchRealms } from '@/actions/lobby';\nimport Renderer from '@/components/renderer';\nimport Floor from '@/components/lobby/floor';\nimport Menu from '@/components/lobby/menu';\nimport Title from '@/components/lobby/title';\n\nclass Lobby extends PureComponent {\n  componentDidMount() {\n    const {\n      history,\n      renderer: { current: renderer },\n      fetchRealms,\n    } = this.props;\n    const anisotropy = renderer.getMaxAnisotropy();\n    const scene = renderer.resetScene();\n    scene.add(new Floor());\n    scene.add(new Title({ anisotropy }));\n    this.menu = new Menu({\n      anisotropy,\n      history,\n    });\n    scene.add(this.menu);\n    this.renderer = renderer;\n    this.scene = scene;\n    scene.onBeforeRender = this.onBeforeRender.bind(this);\n    fetchRealms({ page: 0 });    \n  }\n\n  componentDidUpdate({ realms: previousRealms }) {\n    const { realms } = this.props;\n    if (realms !== previousRealms) {\n      this.menu.update(realms);\n    }\n  }\n\n  componentWillUnmount() {\n    const { scene } = this;\n    delete scene.onBeforeRender;\n  }\n\n  onBeforeRender() {\n    const {\n      menu,\n      renderer: {\n        hands,\n        raycaster,\n      },\n    } = this;\n\n    // Handle controls\n    hands.children.forEach((hand, i) => {\n      const { buttons, pointer } = hand;\n      hand.setupRaycaster(raycaster);\n      const hit = raycaster.intersectObjects(menu.children)[0] || false;\n      if (!hit) {\n        pointer.visible = false;\n        menu.setHover({ hand: i });\n        return;\n      }\n      const {\n        distance,\n        object,\n      } = hit;\n      // Pointer feedback\n      pointer.scale.z = distance - 0.175;\n      pointer.visible = true;\n      // Menu\n      object.onPointer({\n        hand: i,\n        isDown: buttons.triggerDown,\n      });\n    });\n  }\n\n  render() {\n    return null;\n  }\n}\n\nLobby.propTypes = {\n  // eslint-disable-next-line react/forbid-prop-types\n  history: PropTypes.object.isRequired,\n  realms: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    slug: PropTypes.string.isRequired,\n  })).isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n  fetchRealms: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    lobby: {\n      realms,\n    },\n  }) => ({\n    realms,\n  }),\n  {\n    fetchRealms,\n  }\n)(Lobby);\n","import * as types from './types';\nimport API from '@/services/api';\n\n// eslint-disable-next-line import/prefer-default-export\nexport function fetchRealms({\n  page = 0,\n}) {\n  return {\n    type: types.LOBBY_FETCH_REALMS,\n    payload: API.fetch({\n      endpoint: `realms/${page}`,\n    }),\n  };\n}\n","import Worker from '@/services/mesher.worker';\n\nclass Mesher {\n  constructor() {\n    this.promiseId = 0;\n    this.promises = {};\n    this.worker = new Worker();\n    this.worker.onmessage = this.onMessage.bind(this);\n  }\n\n  generate({ size, voxels }) {\n    const { promiseId, promises, worker } = this;\n    return new Promise((resolve) => {\n      promises[promiseId] = resolve;\n      this.promiseId += 1;\n      worker.postMessage({\n        promiseId,\n        size,\n        voxels,\n      });\n    });\n  }\n\n  onMessage({ data: { geometry, promiseId } }) {\n    const { promises } = this;\n    promises[promiseId](geometry);\n    delete promises[promiseId];\n  }\n}\n\nexport default new Mesher();\n","import * as types from './types';\nimport API from '@/services/api';\nimport Mesher from '@/services/mesher';\n\nexport function create({\n  name,\n}) {\n  return {\n    type: types.REALM_CREATE,\n    payload: API.fetch({\n      body: {\n        name,\n      },\n      endpoint: 'realm',\n      method: 'PUT',\n    }),\n  };\n}\n\nexport function generateGeometry({ size, voxels }) {\n  return {\n    type: types.REALM_UPDATE_GEOMETRY,\n    payload: Mesher.generate({ size, voxels }),\n  };\n}\n\nexport function fetch(slug) {\n  return dispatch => dispatch({\n    type: types.REALM_FETCH,\n    payload: API.fetch({\n      endpoint: `realm/${slug}`,\n    })\n      .then(realm => (\n        API.fetch({\n          endpoint: `realm/${realm._id}/voxels`,\n        })\n          .then((voxels) => {\n            voxels = new Uint32Array(voxels);\n            dispatch(generateGeometry({ size: realm.size, voxels }));\n            return {\n              ...realm,\n              voxels,\n            };\n          })\n      )),\n  });\n}\n\nexport function reset() {\n  return {\n    type: types.REALM_RESET,\n  };\n}\n\nexport function updateVoxels({\n  color,\n  normal,\n  point,\n  remove,\n}) {\n  return (dispatch, getState) => {\n    const { realm: { size, voxels: current } } = getState();\n    const [x, y, z] = ['x', 'y', 'z'].map((axis) => {\n      let position = Math.floor(point[axis] + (normal[axis] * 0.5 * (remove ? -1 : 1)));\n      while (position < 0) position += size;\n      while (position >= size) position -= size;\n      return position;\n    });\n    const randomized = {\n      r: Math.min(Math.max(Math.round((color.r * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n      g: Math.min(Math.max(Math.round((color.g * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n      b: Math.min(Math.max(Math.round((color.b * 0xFF) + (Math.random() * 8) - 4), 0), 255),\n    };\n    const value = remove ? (\n      0x00\n    ) : (\n      (0x01 << 24) | (randomized.r << 16) | (randomized.g << 8) | randomized.b\n    );\n    const voxels = new Uint32Array(current);\n    voxels[z * size * size + y * size + x] = value;\n    dispatch(generateGeometry({ size, voxels }));\n    return dispatch({\n      type: types.REALM_UPDATE_VOXELS,\n      payload: { voxels },\n    });\n  };\n}\n","import { Color } from 'three';\nimport Panel from '@/components/panel';\n\nclass Picker extends Panel {\n  constructor({ anisotropy }) {\n    super({ anisotropy });\n    const { renderer } = this;\n    this.position.set(-0.15, 0.15, 0.075);\n    this.rotation.set(0, Math.PI * 0.5, Math.PI * 0.1, 'ZYX');\n    this.scale.set(0.3, 0.3, 1);\n    this.block = {\n      x: renderer.width * 0.05,\n      y: renderer.height * 0.05,\n      width: renderer.width * 0.75,\n      height: renderer.height * 0.75,\n    };\n    this.strip = {\n      x: renderer.width * 0.85,\n      y: renderer.height * 0.05,\n      width: renderer.width * 0.1,\n      height: renderer.height * 0.75,\n    };\n    this.blockColor = new Color();\n    this.color = new Color();\n    this.blockColor.setRGB(1, 0, 0);\n    this.color.copy(this.blockColor);\n    this.draw();\n  }\n\n  draw() {\n    const {\n      block,\n      blockColor,\n      color,\n      context: ctx,\n      renderer,\n      strip,\n    } = this;\n\n    super.draw();\n\n    {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = block;\n      ctx.save();\n      ctx.translate(x, y);\n      ctx.fillStyle = `#${blockColor.getHexString()}`;\n      ctx.fillRect(0, 0, width, height);\n\n      const grdWhite = ctx.createLinearGradient(0, 0, width, 0);\n      grdWhite.addColorStop(0, 'rgba(255,255,255,1)');\n      grdWhite.addColorStop(1, 'rgba(255,255,255,0)');\n      ctx.fillStyle = grdWhite;\n      ctx.fillRect(0, 0, width, height);\n\n      const grdBlack = ctx.createLinearGradient(0, 0, 0, height);\n      grdBlack.addColorStop(0, 'rgba(0,0,0,0)');\n      grdBlack.addColorStop(1, 'rgba(0,0,0,1)');\n      ctx.fillStyle = grdBlack;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    {\n      const {\n        x,\n        y,\n        width,\n        height,\n      } = strip;\n      ctx.save();\n      ctx.translate(x, y);\n      const grd = ctx.createLinearGradient(0, 0, 0, height);\n      grd.addColorStop(0, 'rgba(255, 0, 0, 1)');\n      grd.addColorStop(0.17, 'rgba(255, 255, 0, 1)');\n      grd.addColorStop(0.34, 'rgba(0, 255, 0, 1)');\n      grd.addColorStop(0.51, 'rgba(0, 255, 255, 1)');\n      grd.addColorStop(0.68, 'rgba(0, 0, 255, 1)');\n      grd.addColorStop(0.85, 'rgba(255, 0, 255, 1)');\n      grd.addColorStop(1, 'rgba(255, 0, 0, 1)');\n      ctx.fillStyle = grd;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n\n    {\n      ctx.save();\n      const width = renderer.width * 0.3;\n      const height = renderer.width * 0.1;\n      ctx.translate(renderer.width * 0.35, renderer.height * 0.85);\n      ctx.rect(0, 0, width, height);\n      ctx.fillStyle = `#${color.getHexString()}`;\n      ctx.fillRect(0, 0, width, height);\n      ctx.restore();\n    }\n  }\n\n  onPointer(point) {\n    const {\n      block,\n      blockColor,\n      color,\n      context: ctx,\n      pointer,\n      strip,\n    } = this;\n    super.onPointer(point);\n    [block, strip].forEach(({\n      x,\n      y,\n      width,\n      height,\n    }, i) => {\n      if (\n        pointer.x < x\n        || pointer.x > x + width\n        || pointer.y < y\n        || pointer.y > y + height\n      ) {\n        return;\n      }\n      const isStrip = i === 1;\n      const imageData = ctx.getImageData(pointer.x, pointer.y, 1, 1).data;\n      if (isStrip) {\n        blockColor.setRGB(\n          imageData[0] / 0xFF,\n          imageData[1] / 0xFF,\n          imageData[2] / 0xFF\n        );\n      }\n      color.setRGB(\n        imageData[0] / 0xFF,\n        imageData[1] / 0xFF,\n        imageData[2] / 0xFF\n      );\n      this.draw();\n    });\n  }\n}\n\nexport default Picker;\n","import {\n  BufferAttribute,\n  BufferGeometry,\n  Mesh,\n  MeshBasicMaterial,\n  Object3D,\n  VertexColors,\n} from 'three';\n\nclass Voxels extends Object3D {\n  constructor() {\n    super();\n    this.geometry = new BufferGeometry();\n    this.material = new MeshBasicMaterial({\n      vertexColors: VertexColors,\n    });\n    this.visible = false;\n  }\n\n  resize(size) {\n    const { children, geometry, material } = this;\n    const radius = 8;\n    while (children.length) {\n      this.remove(children[0]);\n    }\n    // TODO:\n    // This should really use an InstancedBufferGeometry\n    // But I need to figure out how to keep the raycasting\n    // and fustrum culling functionality\n    // Maybe I'll use an hybrid approach... Like:\n    // The closest chunks as full meshes and the further chunks instanced\n    for (let z = -radius; z <= radius; z += 1) {\n      for (let y = -radius; y <= radius; y += 1) {\n        for (let x = -radius; x <= radius; x += 1) {\n          const instance = new Mesh(\n            geometry,\n            material\n          );\n          instance.matrixAutoUpdate = false;\n          instance.position.set(x * size, y * size, z * size);\n          instance.updateMatrix();\n          this.add(instance);\n        }\n      }\n    }\n  }\n\n  update({\n    index,\n    position,\n    color,\n    normal,\n  }) {\n    const { geometry } = this;\n    if (geometry.attributes.position) {\n      geometry.attributes.position.setArray(position);\n      geometry.attributes.position.needsUpdate = true;\n    } else {\n      geometry.addAttribute('position', new BufferAttribute(position, 3));\n    }\n    if (geometry.attributes.color) {\n      geometry.attributes.color.setArray(color);\n      geometry.attributes.color.needsUpdate = true;\n    } else {\n      geometry.addAttribute('color', new BufferAttribute(color, 3));\n    }\n    if (geometry.attributes.normal) {\n      geometry.attributes.normal.setArray(normal);\n      geometry.attributes.normal.needsUpdate = true;\n    } else {\n      geometry.addAttribute('normal', new BufferAttribute(normal, 3));\n    }\n    if (geometry.index) {\n      geometry.index.setArray(index);\n      geometry.index.needsUpdate = true;\n    } else {\n      geometry.setIndex(new BufferAttribute(index, 1));\n    }\n    geometry.computeBoundingSphere();\n    this.visible = true;\n  }\n}\n\nexport default Voxels;\n","import PropTypes from 'prop-types';\nimport { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { Vector3 } from 'three';\nimport { fetch, reset, updateVoxels } from '@/actions/realm';\nimport Renderer from '@/components/renderer';\nimport Picker from '@/components/realm/picker';\nimport Voxels from '@/components/realm/voxels';\n\nclass Realm extends PureComponent {\n  componentDidMount() {\n    const {\n      match: { params: { slug } },\n      renderer: { current: renderer },\n      fetch,\n    } = this.props;\n    const scene = renderer.resetScene();\n    this.picker = new Picker({\n      anisotropy: renderer.getMaxAnisotropy(),\n    });\n    renderer.hands.children[1].add(this.picker);\n    this.intersects = [this.picker];\n    this.voxels = new Voxels();\n    scene.add(this.voxels);\n    this.head = new Vector3();\n    this.renderer = renderer;\n    this.scene = scene;\n    scene.onBeforeRender = this.onBeforeRender.bind(this);\n    fetch(slug);\n  }\n\n  componentDidUpdate({ geometry: previousGeometry, size: previousSize }) {\n    const { geometry, size } = this.props;\n    const { renderer: { room }, picker, voxels } = this;\n    if (size !== previousSize) {\n      room.position.set(\n        size * 0.5,\n        size * 0.5,\n        size * 0.5\n      );\n      voxels.resize(size);\n      this.intersects = [\n        picker,\n        ...voxels.children,\n      ];\n    }\n    if (geometry !== previousGeometry) {\n      voxels.update(geometry);\n    }\n  }\n\n  componentWillUnmount() {\n    const { picker, renderer, scene } = this;\n    const { reset } = this.props;\n    renderer.hands.children[1].remove(picker);\n    delete scene.onBeforeRender;\n    reset();\n    if (!renderer.renderer.vr.enabled) {\n      renderer.resetCamera();\n    }\n  }\n\n  onBeforeRender(renderer, scene, camera) {\n    const {\n      head,\n      intersects,\n      picker,\n      props: {\n        size,\n        updateVoxels,\n      },\n      renderer: {\n        hands,\n        raycaster,\n        room,\n      },\n    } = this;\n\n    // Handle controls\n    hands.children.forEach((hand) => {\n      const { buttons, pointer } = hand;\n      hand.setupRaycaster(raycaster);\n      const hit = raycaster.intersectObjects(intersects)[0] || false;\n      if (!hit) {\n        pointer.visible = false;\n        return;\n      }\n      const {\n        distance,\n        face: { normal },\n        object,\n        point,\n      } = hit;\n      // Pointer feedback\n      pointer.scale.z = distance - 0.175;\n      pointer.visible = true;\n      // Color picker\n      if (object === picker) {\n        if (buttons.triggerDown) {\n          picker.onPointer(point);\n        }\n        return;\n      }\n      // Translocation\n      if (\n        buttons.padDown\n        && normal.x === 0\n        && normal.y === 1\n        && normal.z === 0\n      ) {\n        head.setFromMatrixPosition(camera.matrixWorld);\n        const offset = {\n          x: head.x - room.position.x,\n          y: 0,\n          z: head.z - room.position.z,\n        };\n        const [x, y, z] = ['x', 'y', 'z'].map((axis) => {\n          let position = point[axis] - offset[axis];\n          while (position < 0) position += size;\n          while (position >= size) position -= size;\n          return position;\n        });\n        room.position.set(x, y, z);\n      }\n      // Voxel update\n      if (\n        buttons.triggerDown\n        || buttons.gripDown\n      ) {\n        updateVoxels({\n          color: picker.color,\n          point,\n          normal,\n          remove: buttons.gripDown,\n        });\n      }\n    });\n\n    // Animation for non-vr browsers\n    const { animation, vr } = renderer;\n    if (!vr.enabled && size) {\n      const { delta, time } = animation;\n      const rotation = Math.sin(time * 0.1) * 0.001;\n      camera.rotateY(rotation);\n      camera.rotateX(rotation);\n      camera.translateZ(delta * 0.5);\n      camera.updateMatrixWorld();\n      ['x', 'y', 'z'].forEach((axis) => {\n        if (camera.position[axis] < 0) {\n          camera.position[axis] += size;\n        }\n        if (camera.position[axis] >= size) {\n          camera.position[axis] -= size;\n        }\n      });\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nRealm.propTypes = {\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      slug: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  geometry: PropTypes.shape({\n    index: PropTypes.instanceOf(Uint32Array),\n    position: PropTypes.instanceOf(Float32Array),\n    color: PropTypes.instanceOf(Float32Array),\n    normal: PropTypes.instanceOf(Float32Array),\n  }).isRequired,\n  size: PropTypes.number.isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n  fetch: PropTypes.func.isRequired,\n  reset: PropTypes.func.isRequired,\n  updateVoxels: PropTypes.func.isRequired,\n};\n\nexport default connect(\n  ({\n    realm: {\n      geometry,\n      size,\n    },\n  }) => ({\n    geometry,\n    size,\n  }),\n  {\n    fetch,\n    reset,\n    updateVoxels,\n  }\n)(Realm);\n","import PropTypes from 'prop-types';\nimport React from 'react';\nimport { Route, Redirect, Switch } from 'react-router-dom';\nimport Renderer from '@/components/renderer';\nimport Lobby from './lobby';\nimport Realm from './realm';\n\nconst Scene = ({\n  component: Component,\n  renderer,\n  ...rest\n}) => (\n  <Route\n    {...rest}\n    render={props => (\n      <Component {...props} renderer={renderer} />\n    )}\n  />\n);\n\nScene.propTypes = {\n  component: PropTypes.func.isRequired,\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n};\n\nconst Scenes = ({ renderer }) => (\n  <Switch>\n    <Scene exact path=\"/\" component={Lobby} renderer={renderer} />\n    <Scene exact path=\"/:slug\" component={Realm} renderer={renderer} />\n    <Redirect to=\"/\" />\n  </Switch>\n);\n\nScenes.propTypes = {\n  renderer: PropTypes.shape({\n    current: PropTypes.instanceOf(Renderer),\n  }).isRequired,\n};\n\nexport default Scenes;\n","import React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport LoadingBar from 'react-redux-loading-bar';\nimport styled from 'styled-components';\nimport Renderer from '@/components/renderer';\nimport Session from '@/components/session';\nimport Scenes from '@/scenes';\n\nconst Wrapper = styled.div`\n  width: 100vw;\n  height: 100vh;\n`;\n\nconst loadingBarStyle = {\n  backgroundColor: '#393',\n  zIndex: 1,\n};\n\nclass Layout extends PureComponent {\n  constructor(props) {\n    super(props);\n    this.renderer = React.createRef();\n  }\n\n  render() {\n    const { renderer } = this;\n    return (\n      <div>\n        <LoadingBar style={loadingBarStyle} />\n        <Wrapper>\n          <Renderer ref={renderer} />\n        </Wrapper>\n        <Scenes renderer={renderer} />\n        <Session />\n      </div>\n    );\n  }\n}\n\nexport default hot(module)(Layout);\n","import { createBrowserHistory } from 'history';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport { applyMiddleware, createStore, compose as productionCompose } from 'redux';\nimport promiseMiddleware from 'redux-promise-middleware';\nimport { Provider } from 'react-redux';\nimport { loadingBarMiddleware } from 'react-redux-loading-bar';\nimport { Router } from 'react-router-dom';\nimport thunkMiddleware from 'redux-thunk';\nimport { refreshSession } from '@/actions/user';\nimport syncTranslationWithStore, { load as reloadLocales } from '@/locales';\nimport rootReducer from '@/reducers';\nimport Layout from '@/layout';\n\n// Create Redux Store\nconst devCompose = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__;\nconst compose = !__PRODUCTION__ && devCompose ? devCompose : productionCompose;\nconst store = createStore(\n  rootReducer,\n  {},\n  compose(\n    applyMiddleware(thunkMiddleware, promiseMiddleware, loadingBarMiddleware())\n  )\n);\nsyncTranslationWithStore(store);\n\n// Revive session from localStorage\nif (store.getState().user.isAuth) {\n  store.dispatch(refreshSession());\n}\n\n// Create router history\nconst history = createBrowserHistory({\n  basename: __BASENAME__,\n});\n\n// Support initial hash route from the ghpages-spa-webpack-plugin\nif (window.location.hash) {\n  history.replace(`/${window.location.hash.substr(2)}`);\n}\n\n// Disable contextual menus\nwindow.addEventListener('contextmenu', e => (\n  e.preventDefault()\n), false);\n\n// Render the page\nconst mount = document.getElementById('mount');\nrender(\n  <Provider store={store}>\n    <Router history={history}>\n      <Layout />\n    </Router>\n  </Provider>,\n  mount\n);\n\n// Hot reload locales & reducers\nif (!__PRODUCTION__ && module.hot) {\n  module.hot.accept('@/locales', () => reloadLocales(store));\n  module.hot.accept('@/reducers', () => store.replaceReducer(rootReducer));\n}\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"code/mesher.worker.cdf4d0fc1592aac67598.js\");\n};"],"sourceRoot":""}